众所周知，NodeJS作为后端开发语言和运行环境，支持高并发、开发效率高，有口皆碑，但是大多用于`数据CRUD管理`、`中间层聚合`和`中间层代理`等工具场景，很少深入到业务领域的核心。有许多用NodeJS开发的`最小可用产品（MVP）`最终会另起炉灶重构，这是原因之一

究其根源，NodeJS作为业务开发平台，还缺少许多核心的基础构件，`NodeJS工作流引擎`便是其一。CabloyJS提供了NodeJS工作流引擎，并作为内置的基础核心模块（同样是开源、免费），近一步拓展了NodeJS在后端的应用场景，为深入研发各类商业业务逻辑，提供了基础支撑

那么，我们就来看看如何为业务表单`出差申请`添加审批工作流？

## 1. 新建流程定义

通过菜单`新建/新建流程定义`创建一个新的流程定义，名称修改为`出差申请审核`，然后点击`内容`，进入流程图的编辑页面

![1](https://admin.cabloy.com/api/a/file/file/download/925c537ea0254987aee121150100a16c.png)

![2](https://admin.cabloy.com/api/a/file/file/download/a193a4bc337d47b1b39eb3d14146413d.png)

## 2. 添加节点：数据起草开始事件

在流程图编辑页面，点击`添加节点`，选择`数据起草开始事件`，编辑页面就会出现一个`节点`。单击该节点，打开属性页面，点击`选项/数据类型`，选择`出差申请`，其他选项保留默认值

![3](https://admin.cabloy.com/api/a/file/file/download/48006f83a1fe4d73a567e751797e6b75.png)

在这里我们简单解释一下选择`数据类型`的意义。当我们编辑好流程定义并提交生效后，系统会自动`部署流程定义`。当我们新建一个`出差申请`，然后将`出差申请`的`草稿`提交时，系统就会通过`数据类型`选项自动检索对应的流程定义，然后创建一个流程实例，从而进入审批流程中

> 简而言之，选项`数据类型`实现了`业务表单`与`工作流`的绑定关系

## 3. 添加节点：用户任务活动

再次点击`添加节点`，选择`用户任务活动`，编辑页面就会出现一个`节点`。从节点`数据起草开始事件`拖拽一条`连接线`至节点`用户任务活动`。然后再单击该节点，打开属性页面，点击`选项/参与人`。为了测试的便利，我们在弹出的页面中添加`变量/流程发起人`。其他选项保留默认值

![1](https://admin.cabloy.com/api/a/file/file/download/f4372dcd02c2405a85f899a97dae53d7.png)

![2](https://admin.cabloy.com/api/a/file/file/download/ac24dffcaf19408097ab53089e5d83ba.png)

## 4. 添加节点：数据提交结束事件

再次点击`添加节点`，选择`数据提交结束事件`，编辑页面就会出现一个`节点`。从节点`用户任务活动`拖拽一条`连接线`至节点`数据提交结束事件`。至此，我们的审核工作流就已经定义好了

![1](https://admin.cabloy.com/api/a/file/file/download/fa1417f9317249daa1fdbcab0a8ad6f6.png)

## 5. 提交生效

我们知道`出差申请`是业务数据，事实上，`工作流定义`也是业务数据，因此具有相同的数据管理模式。前面我们创建的工作流定义目前还是处于`草稿`状态。我们只需点击`提交`，就会基于草稿生成正式的业务数据，工作流定义也就自动部署，并且生效了

接下来，我们新建`出差申请`时，填写完表单，点击`提交`，就会自动启动审核流程了